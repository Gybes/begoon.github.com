---
layout: post
title: "Анализатор цифровых сигналов Saleae Logic"
language: russian
date: 2012-09-07 22:02
comments: true
categories: 
- oscilloscope
- russian
- saleae
---
Играясь с [GMC-4][Микрокомпьютер GMC-4] и обдумывая план создания 
[автоматического загрузчика][Загрузчик для GMC-4 в сборе],
стало ясно, что одним тестером я не справлюсь в плане анализа работы
клавиатуры GMC-4. Возникла идея купить осциллограф. Брать "настоящий"
типа Rigol'а как-то не срослось, а [Вячеслав Славинский][] навел на вот
такой девайс: [Saleae Logic][]. Конечно, это НЕ осциллограф, а
несложный анализатор цифровых сигналов. И как раз то, что мне было нужно.
Понимает протоколы UART, SPI, I2C и т.д. 

[Микрокомпьютер GMC-4]: /blog/russian/2012/07/04/gmc-4/
[Загрузчик для GMC-4 в сборе]: /blog/russian/2012/07/25/gmc4-loader-assembled/

[Вячеслав Славинский]: http://sensi.org/~svo/
[Saleae Logic]: http://www.saleae.com/logic/

Цена вопроса была 128€ + 25.80€ НДС. Удобно было, что у них есть склад 
в UK, поэтому доставка была бесплатной, быстрой и без таможни.

Изначально мой план был купить, поерзать немного и вернуть, ибо у них
четко сказано, что в течение месяца можно вернуть **без объяснения причины**.
Вот это, кстати, правильный и современный подход, и не будь этого условия,
я бы может и не купил бы. 

![](/images/blog/saleae-logic/IMG_0530.JPG)

![](/images/blog/saleae-logic/IMG_0531.JPG)

Оказалось, что это все на всего маленькая металлическая коробочка со
спичечный коробок.

![](/images/blog/saleae-logic/IMG_0532.JPG)

![](/images/blog/saleae-logic/IMG_0534.JPG)

Комплектация

![](/images/blog/saleae-logic/IMG_0535.JPG)

Подключаем...

![](/images/blog/saleae-logic/IMG_0536.JPG)

В качестве теста я подцепил на последовательный порт Raspberry Pi,
по которому в данный момент телнетом сидел в консоли.

![](/images/blog/saleae-logic/IMG_0537.JPG)

Фрагмент захвата, где видно, что пролетает командочка `ls` по одному
проводу и эхом летит назад по другому.

![](/images/blog/saleae-logic/saleae-logic-analyser-ls-command.jpg)

Теперь клавиатура GMC-4. Она сделана по 
[классической схеме][Scanned keyboard], когда
по ножкам одного порта последовательно "летает" единичка, которая 
"выбирает" номер текущего ряда кнопок, а со второго порта просто 
считывается маска состояния кнопок выбранного ряда. Это позволяет
значительно сократить количество отведенных под обслуживание 
клавиатуры ножек.

[Scanned keyboard]: http://www.learningaboutelectronics.com/Articles/How-does-a-matrix-keyboard-scanning-algorithm-work

![](/images/blog/saleae-logic/gmc4-schematic.jpg)

А так как я собирался имитировать клавиатуру, мне надо было понять
временные параметры сканирующего сигнала. Подвесил я на анализ
все четыре сканирующих выхода и вот:

![](/images/blog/saleae-logic/saleae-logic-analyser-gmc4-keyboard.jpg)

Сразу видно, что к чему. При анализе можно измерять практически
все параметры сигнала, менять масштаб, сравнивать с предыдущими
замерами и т.д. На сайте [есть видео в хорошем качестве][Videos],
где все это подробно объясняется. У меня в электронике статус
дилетанта, так что меня вставило от простоты анализа, но тот же
товарищ Славинский говорит, что при анализе сложной цифровой схемы
бывает крайне удобно, если можно захватывает не один, не два, а
много сигналов одновременно.

[Videos]: http://www.saleae.com/logic/videos

Как вы уже поняли, возвращать девайс я не стал, хотя у меня была претензия
к ним. У меня не получилось делать захват на максимальной частоте
в 24MHz. Программа говорила, что девайс не успевает. Суппорт сказал,
что может быть это связано с конкретно моим USB-хабом, но я разное
перепробовал - проблема не исчезла. Они не отказывались ни разу
взять девайс назад, но я его не отдал. Уж больно он мне понравился,
и все мои текущие задачи он прекрасно решает.

Итоги
-----

### Плюсы

* Крайне прост в использовании. 
* Есть управляемые триггеры для начала захвата (по уровню, по фронту и т.д.).
* 8 или 16 каналов, в зависимости от модели, одновременного захвата.
* 100% money back в течение месяца, и вообще, у официальной поддержки
  крайне человеческое лицо.

### Минусы

* Нет режима online-просмотра. Сначала делается захват, а потом результат
  захвата можно просматривать, анализировать и т.д. Поэтому, не стоит ожидать
  ощущения "как на настоящем осциллографе".
* У меня на Mac Air не получилось делает захват на максимальной частоте 24MHz.
  Выглядело, будто не успевает по USB прокачивать данные на должной скорости.

### Одним словом

Рекомендую.
